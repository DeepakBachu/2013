Index: libmicrohttpd-0.9.5/src/daemon/digestauth.c
===================================================================
--- libmicrohttpd-0.9.5.orig/src/daemon/digestauth.c
+++ libmicrohttpd-0.9.5/src/daemon/digestauth.c
@@ -723,8 +723,8 @@ MHD_queue_basic_auth_fail_response(struc
 				   struct MHD_Response *response) 
 {
   int ret;
-  size_t hlen = strlen(realm) + strlen("Basic realm=\"\"") + 1;
-  char header[hlen];
+  size_t hlen = strlen(realm) + strlen("Basic realm=\"\"");
+  char header[hlen + 1];
 
   if (hlen !=
       snprintf(header, 
