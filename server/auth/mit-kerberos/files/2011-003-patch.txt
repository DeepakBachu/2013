Index: krb5-1.7.1/src/kdc/do_as_req.c
===================================================================
--- krb5-1.7.1.orig/src/kdc/do_as_req.c
+++ krb5-1.7.1/src/kdc/do_as_req.c
@@ -790,6 +790,8 @@ prepare_error_as (struct kdc_request_sta
 		pad->contents = td[size]->data;
 		pad->length = td[size]->length;
 		pa[size] = pad;
+		td[size]->data = NULL;
+		td[size]->length = 0;
 	    }
 	    krb5_free_typed_data(kdc_context, td);
 	}
