From: Jeff Mahoney <jeffm@suse.com>
Subject: AppArmor: Add option for default lsm
Patch-mainline: Probably never; Whenever AppArmor is accepted upstream

 This patch adds an option for AppArmor to be the default (and favored)
 LSM if configured.

Signed-off-by: Jeff Mahoney <jeffm@suse.com>
---
 security/Kconfig |    5 +++++
 1 file changed, 5 insertions(+)

--- a/security/Kconfig
+++ b/security/Kconfig
@@ -146,6 +146,7 @@ source security/integrity/ima/Kconfig
 
 choice
 	prompt "Default security module"
+	default DEFAULT_SECURITY_APPARMOR if SECURITY_APPARMOR
 	default DEFAULT_SECURITY_SELINUX if SECURITY_SELINUX
 	default DEFAULT_SECURITY_SMACK if SECURITY_SMACK
 	default DEFAULT_SECURITY_TOMOYO if SECURITY_TOMOYO
@@ -155,6 +156,9 @@ choice
 	  Select the security module that will be used by default if the
 	  kernel parameter security= is not specified.
 
+	config DEFAULT_SECURITY_APPARMOR
+		bool "AppArmor" if SECURITY_APPARMOR=y
+
 	config DEFAULT_SECURITY_SELINUX
 		bool "SELinux" if SECURITY_SELINUX=y
 
@@ -171,6 +175,7 @@ endchoice
 
 config DEFAULT_SECURITY
 	string
+	default "apparmor" if DEFAULT_SECURITY_APPARMOR
 	default "selinux" if DEFAULT_SECURITY_SELINUX
 	default "smack" if DEFAULT_SECURITY_SMACK
 	default "tomoyo" if DEFAULT_SECURITY_TOMOYO
