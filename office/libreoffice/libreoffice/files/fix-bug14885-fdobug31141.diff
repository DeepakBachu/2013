diff -Naur patches-orig//dev300/apply patches/dev300/apply
--- patches-orig//dev300/apply	2010-11-25 22:49:41.033002288 +0200
+++ patches/dev300/apply	2010-11-25 22:50:42.206001533 +0200
@@ -1615,6 +1615,7 @@
 pardus-xdg-email-senddoc.diff
 fix-kde4-includedir.diff
 fix-jpeg-lib64-dir.diff
+c9b21c9580204dc3b5541900f613dc13be1ae5f9.diff
 
 [ UnUsedButNotYetRemovedFromGit ]
 # diffs kept for reference as there might soon be a need to resurrect
diff -Naur patches-orig//dev300/c9b21c9580204dc3b5541900f613dc13be1ae5f9.diff patch patches/dev300/c9b21c9580204dc3b5541900f613dc13be1ae5f9.diff
--- patches-orig//dev300/c9b21c9580204dc3b5541900f613dc13be1ae5f9.diff 1970-01-01 02:00:00.000000000 +0200
+++ patches/dev300/c9b21c9580204dc3b5541900f613dc13be1ae5f9.diff	2010-11-25 22:50:23.943002225 +0200
@@ -0,0 +1,30 @@
+From c9b21c9580204dc3b5541900f613dc13be1ae5f9 Mon Sep 17 00:00:00 2001
+From: Katarina Machalkova <kmachalkova@suse.cz>
+Date: Thu, 25 Nov 2010 13:34:41 +0000
+Subject: Fixed crash in xls export caused by off-by-one iterator
+
+(this is for bnc#653533 and fdo#31141)
+---
+diff --git a/sc/source/filter/excel/xetable.cxx b/sc/source/filter/excel/xetable.cxx
+index df1273f..7a636df 100644
+--- sc/source/filter/excel/xetable.cxx
++++ sc/source/filter/excel/xetable.cxx
+@@ -2105,7 +2105,6 @@ void XclExpRowBuffer::Save( XclExpStream& rStrm )
+     for (itr = itrBeg; itr != itrEnd; ++itr)
+     {
+         // find end of row block
+-        ++itrBlkEnd;
+         while( (itrBlkEnd != itrEnd) && (itrBlkEnd->second->GetXclRow() - nStartXclRow < EXC_ROW_ROWBLOCKSIZE) )
+             ++itrBlkEnd;
+ 
+@@ -2118,7 +2117,7 @@ void XclExpRowBuffer::Save( XclExpStream& rStrm )
+         for( itRow = itrBlkStart; itRow != itrBlkEnd; ++itRow )
+              itRow->second->WriteCellList( rStrm );
+ 
+-        itrBlkStart = itrBlkEnd;
++        itrBlkStart = (itrBlkEnd == itrEnd) ? itrBlkEnd : itrBlkEnd++;
+         nStartXclRow += EXC_ROW_ROWBLOCKSIZE;
+     }
+ }
+--
+cgit v0.8.3-6-g21f6
