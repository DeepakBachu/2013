From 57f3c0a7e392ee368fd2daaae486aadeb259acb8 Mon Sep 17 00:00:00 2001
From: mete <mete@26e1f6f6-46e4-0310-a0b7-a8a415fd4c45>
Date: Wed, 25 May 2011 23:32:17 +0000
Subject: [PATCH 09/10] Fix Password rescue screen exception

git-svn-id: https://svn.pardus.org.tr/uludag/trunk/yali@36992 26e1f6f6-46e4-0310-a0b7-a8a415fd4c45
---
 yali/gui/ScrRescuePassword.py |   13 ++++++-------
 1 files changed, 6 insertions(+), 7 deletions(-)

diff --git a/yali/gui/ScrRescuePassword.py b/yali/gui/ScrRescuePassword.py
index 7ca7d10..205b6f9 100644
--- a/yali/gui/ScrRescuePassword.py
+++ b/yali/gui/ScrRescuePassword.py
@@ -17,7 +17,6 @@ _ = gettext.translation('yali', fallback=True).ugettext
 from PyQt4.Qt import QWidget, SIGNAL, QListWidgetItem, QIcon, QLineEdit
 
 import yali.util
-import yali.postinstall
 import yali.context as ctx
 from yali.gui import ScreenWidget
 from yali.gui.Ui.rescuepasswordwidget import Ui_RescuePasswordWidget
@@ -112,12 +111,12 @@ class Widget(QWidget, ScreenWidget):
             self.ui.resetPassword.setEnabled(True)
 
     def fillUsers(self):
-        if yali.util.check_link():
-            self.ui.users.clear()
-            users = yali.postinstall.getUsers()
-            for user in users:
-                RescueUser(self.ui.users, user)
-        else:
+        self.ui.users.clear()
+        users = yali.util.getUsers()
+        for user in users:
+            RescueUser(self.ui.users, user)
+
+        if not self.ui.users.count():
             rc = ctx.interface.messageWindow(_("Cannot Rescue"),
                                              _("Your current installation cannot be rescued."),
                                              type="custom", customIcon="warning",
-- 
1.7.5

