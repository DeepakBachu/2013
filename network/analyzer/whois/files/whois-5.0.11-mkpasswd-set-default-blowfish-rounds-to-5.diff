From 45731d21f551b72e10e211edfa1b3c4e2ed3f8ad Mon Sep 17 00:00:00 2001
From: Ludwig Nussel <ludwig.nussel@suse.de>
Date: Thu, 14 Jul 2011 13:39:07 +0200
Subject: [PATCH whois 5/7] set default blowfish rounds to 5

five rounds is the crypt_blowfish default
---
 mkpasswd.c |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

Index: mkpasswd.c
===================================================================
--- mkpasswd.c.orig
+++ mkpasswd.c
@@ -223,8 +223,8 @@ int main(int argc, char *argv[])
     }
 
     if (streq(salt_prefix, "$2a$")) {		/* OpenBSD Blowfish  */
-	if (rounds <= 4)
-	    rounds = 4;
+	if (rounds < 5)
+	    rounds = 5;
 	/* actually for 2a it is the logarithm of the number of rounds */
 	snprintf(rounds_str, sizeof(rounds_str), "%02u$", rounds);
     } else if (rounds_support && rounds)
